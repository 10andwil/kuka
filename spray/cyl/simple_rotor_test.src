&ACCESS RVP
&REL 4
&PARAM TEMPLATE = C:\KRC\Roboter\Template\vorgabe
&PARAM EDITMASK = *
DEF new_rotor_test( )
REAL step

;INITIALIZE TIMERS (DEVELOPED BY AW 2022-09-19)
$TIMER_STOP[1]=FALSE ;starts timer 1. unit is milliseconds

INTERRUPT DECL 1 WHEN $TIMER[1]>1201 DO RESET_TIMERS() ;81 is the priority, below the automatic allocations for the robot system
INTERRUPT ON 1

RESET_TIMERS ()

;FOLD INI
  ;FOLD BASISTECH INI

    GLOBAL INTERRUPT DECL 3 WHEN $STOPMESS==TRUE DO IR_STOPM ( )
	INTERRUPT ON 3 
    BAS (#INITMOV,0 )
  ;ENDFOLD (BASISTECH INI)

;ENDFOLD (INI)

;FOLD PTP HOME CONT Vel=50 % DEFAULT;%{PE}%R 5.6.13,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:HOME, 3:C_PTP, 5:50, 7:DEFAULT
$BWDSTART=FALSE
PDAT_ACT=PDEFAULT
FDAT_ACT=FHOME
BAS(#PTP_PARAMS,50)
$H_POS=XHOME
PTP XHOME C_PTP
;ENDFOLD

	;FOLD ; go north east & 8" above workpiece;%{PE}%R 5.6.13,%MKUKATPBASIS,%CCOMMENT,%VNORMAL,%P 2:go north east & 8" above workpiece
	;ENDFOLD
;FOLD PTP P2 Vel=50 % PDAT3 Tool[6]:Spray Gun Base[6]:Spray Gun Base;%{PE}%R 5.6.13,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P2, 3:, 5:50, 7:PDAT3
$BWDSTART=FALSE
PDAT_ACT=PPDAT3
FDAT_ACT=FP2
BAS(#PTP_PARAMS,50)
PTP XP2 
;ENDFOLD

$VEL.CP=0.030

WAIT FOR (($TIMER[1] > 0) AND ($TIMER[1] < 25))
LIN_REL {Y -150}
$VEL.CP=0.1
LIN_REL {Z 10}
LIN_REL {Y 150}
LIN_REL {Z -10}
$VEL.CP=0.03

WAIT FOR (($TIMER[1] > 401) AND ($TIMER[1] < 426))
LIN_REL {Y -150}
$VEL.CP=0.1
LIN_REL {Z 10}
LIN_REL {Y 150}
LIN_REL {Z -10}	
$VEL.CP=0.03

WAIT FOR (($TIMER[1] > 802) AND ($TIMER[1] < 827))
LIN_REL {Y -150}


;FOLD PTP HOME Vel=50 % DEFAULT;%{PE}%R 5.6.13,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:HOME, 3:, 5:50, 7:DEFAULT
$BWDSTART=FALSE
PDAT_ACT=PDEFAULT
FDAT_ACT=FHOME
BAS(#PTP_PARAMS,50)
$H_POS=XHOME
PTP XHOME 
;ENDFOLD

END


; The timer is started or stopped when the advance run pointer has reached the line with the timer.

DEF RESET_TIMERS ()
$TIMER[1] = 0

END